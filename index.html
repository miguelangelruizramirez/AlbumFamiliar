<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>√Ålbum Familiar</title>
<style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; }
    header { background: #222; color: #fff; text-align: center; padding: 25px 15px; }
    header h1, header h2 { margin: 0; }
    header video { width: 100%; max-height: 300px; object-fit: cover; border-radius: 10px; margin-top: 10px; }

    .intro { max-width: 800px; margin: 20px auto; padding: 0 20px; color: #444; text-align: center; line-height: 1.6; }

    .year-section { margin: 25px 0; }
    .year-section h2 { margin-bottom: 10px; color: #333; border-bottom: 2px solid #ccc; padding-bottom: 5px; }

    .gallery, .video-grid {
        display: grid; gap: 12px; margin-top: 10px;
    }
    .gallery { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); }
    .video-grid { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); }

    .gallery-item img, .video-grid video {
        width: 100%; height: 180px; object-fit: cover; border-radius: 8px; transition: 0.3s;
    }
    .gallery-item:hover img, .video-grid video:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }

    /* LIGHTBOX */
    .lightbox {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85);
        display: none; justify-content: center; align-items: center;
        z-index: 999; padding: 20px;
    }
    .lightbox-content { max-width: 90%; max-height: 85%; }
    .lightbox-content video, .lightbox-content img { width: 100%; height: auto; border-radius: 10px; }
    .lightbox span { position: absolute; top: 20px; right: 35px; color: white; font-size: 40px; cursor: pointer; }

    footer { text-align: center; padding: 15px; color: #666; margin-top: 25px; }
</style>
</head>
<body>

<header>
    <h2> üì∏ √Ålbum Familiar ‚Äî Miguel</h2>
    <video class="video-header" autoplay muted loop playsinline>
        <source src="VideosDestacados/FB_VID_5626770404310266269.mp4" type="video/mp4">
    </video>
</header>

<div class="intro">    
    <h1>‚ù§Ô∏è Dedicado a Miguel Angel Ruiz Tlalpan</h1>
    <p>Este repositorio existe para guardar recuerdos que no deben perderse: momentos con mi hijo, con Joss, con mi familia y conmigo mismo. Tambi√©n forma parte de reflexi√≥n, crecimiento y recuperaci√≥n. Aqu√≠ dejo im√°genes, videos y documentos que marcaron etapas importantes de mi vida.</p>
</div>

<!-- CONTENEDOR DE A√ëOS -->
<div id="content"></div>

<!-- LIGHTBOX -->
<div class="lightbox" id="lightbox">
    <span onclick="closeLightbox()">&times;</span>
    <div class="lightbox-content" id="lightbox-content"></div>
</div>

<script>
async function loadMedia() {
    const contentDiv = document.getElementById("content");
    
    // Carpetas principales
    const folders = ["imagenes", "videos"];
    
    for (let folder of folders) {
        const res = await fetch(`https://api.github.com/repos/KATO250712/AlbumFamiliar/contents/${folder}`);
        if (!res.ok) continue;
        const years = await res.json();

        // Filtrar solo carpetas (a√±o)
        for (let year of years.filter(y => y.type === "dir")) {
            const yearDiv = document.createElement("div");
            yearDiv.classList.add("year-section");
            yearDiv.innerHTML = `<h2>${year.name}</h2>`;
            contentDiv.appendChild(yearDiv);

            // Crear contenedor para galer√≠a o videos
            const mediaGrid = document.createElement("div");
            mediaGrid.classList.add(folder === "imagenes" ? "gallery" : "video-grid");
            yearDiv.appendChild(mediaGrid);

            // Obtener archivos dentro del a√±o
            const resFiles = await fetch(year.url);
            if (!resFiles.ok) continue;
            const files = await resFiles.json();

            files.forEach(file => {
                if (folder === "imagenes" && file.name.match(/\.(jpg|jpeg|png|gif|webp)$/i)) {
                    const item = document.createElement("div");
                    item.classList.add("gallery-item");
                    item.innerHTML = `<img src="${file.download_url}">`;
                    item.onclick = () => openLightbox("img", file.download_url);
                    mediaGrid.appendChild(item);
                }
                if (folder === "videos" && file.name.match(/\.(mp4|webm|mov)$/i)) {
                    const video = document.createElement("video");
                    video.src = file.download_url;
                    video.muted = true;
                    video.loop = true;
                    video.autoplay = true;
                    video.onclick = () => openLightbox("video", file.download_url);
                    mediaGrid.appendChild(video);
                }
            });
        }
    }
}

// LIGHTBOX
function openLightbox(type, src) {
    const content = document.getElementById("lightbox-content");
    content.innerHTML = type === "img"
        ? `<img src="${src}">`
        : `<video src="${src}" controls autoplay></video>`;
    document.getElementById("lightbox").style.display = "flex";
}

function closeLightbox() {
    document.getElementById("lightbox").style.display = "none";
    document.getElementById("lightbox-content").innerHTML = "";
}

// Cargar medios
loadMedia();
</script>

<footer>
    <p>"Todo lo que te viniere a la mano para hacer, hazlo seg√∫n tus fuerzas." ‚Äî Eclesiast√©s 9:10</p>
    <p>Conservar recuerdos familiares de la manera m√°s segura y accesible.</p>
    <p>By Miguel Miguel Angel Ruiz Ramirez</p>
</footer>

</body>
</html>
